image: docker:latest

services:
  - docker:dind

stages:
  - build
  - deploy

build_container_teste:
  stage: build
  before_script:
    - echo "Iniciando teste..."
  script:
    - docker build -t app-votacao:1.0
  after_script:
    - echo "Container constru√≠do com sucesso!"
  
deploy:
  needs:
    - build_container_teste
  stage: deploy
  before_script:
    - echo "Subindo container..."
  script:
    - docker compose up -d --build
  after_script:
    - echo "Container no ar!"
